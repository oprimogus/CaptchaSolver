import {Test, TestingModule} from '@nestjs/testing';
import {PuppeterrService} from './puppeterr.service';
import {RecaptchaDto} from "./dto/recaptchaDto";
import {CaptchaType} from "./dto/CaptchaType";
import {timeout} from "rxjs";
import {ImageCaptchaDto} from "./dto/imageCaptchaDto";

describe('PuppeterrService', () => {
  let service: PuppeterrService;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [PuppeterrService],
    }).compile();

    service = module.get<PuppeterrService>(PuppeterrService);
  });

  it('should be defined', () => {
    expect(service).toBeDefined();
  });

  // it('should algo', async () => {
  //   const captcha: RecaptchaDto = {
  //     type: CaptchaType.RECAPTCHA_V2,
  //     page: 'https://www.extratodebito.detran.pr.gov.br/detranextratos/geraExtrato.do?action=iniciarProcesso',
  //     siteKey: '6LdclAgTAAAAALqvqsxODpjjIdgL4cid5Dg0rbUB'
  //   }
  //   const a = await service.getCaptchaToSolve(captcha)
  //   console.log(a)
  //   expect(a).toBeDefined()
  // }, 60000)

  it('should algo 2', async () => {
    const captcha: ImageCaptchaDto = {
      image: 'iVBORw0KGgoAAAANSUhEUgAAALQAAAA3CAIAAAAqi/cTAAAcFklEQVR42u2dCVhTZ9bH7dR+7bS2ta2d2uXr2FZn7NfOjFZwBQUVCyO2uNWluNQFUAgG2VEQiij7IvsStoRNWWWNRpB9XwOGsG9h3wIJISTxfidcDCFsCThTW3mf+/gkN+Emue/vnvP/n/MmLkOExhiXgyyNpfFsLBMmYyVWbvOt01ci7MMLiS39nUtnZwmOycEaY2fWltoSg1Q8dD/SU/jUQOmIl4Hjw5Dc+go2Z2zpZL3UcIiMhh4aIS9JM9Rmo+XJtzAy221+0b3nFFXyqH2wZ+nEvexwCA/G6EgatcgqCafshv1AZ/dfjZVP+JrcSQ0vanrC4XGXzuNLDYfIoHY2B+bEq+Gt/mFxbAVGdqfdRaNo17iy9O6h/qVz+rseT58+nRWOlQEBa8PC5OLjj5NIWllZ5kVFgVRqbGNjZkdH49AQiztDkKCzGA+e5FnE+yi6YEDSrr2ucsrf1DM9sqyVyuXxlk73bzjGRkfofZ2dzdSmqkJKPqkkNTr7fgAp1DnB99d7Trr4mxd9jH5ywSha/7LN/Og3hkqfae9859KW1wR8iMLRw2LV0ulpNFp4XZ1bZSXAcTYtTTk5eWtMzJrQ0Df8/Fb4+8MNoOfIw4dAj3VpKdADz6cMDAyw2XDcqvZ638yYc0EWX9848o72zj2Ol67HeiSRs/uZ9KXZWvDg8bhMen8vrbGVWlZTklGeEZ+fHPL4nkdKoHWMm3GojSbOVNVd5wf7i7ssT2ww+eFLnd0fwDRrbntDT+Gj6wfXWZ2SctTY7al3MND8bLiddpynKTHYLiPap5AYXpmdXFeeTauv7O9sYTHoc0WOp5x5rvXhsTEIISg9zmSyUX4+0AOsrI+IAG6AHjTwqKam6uXmWhblG6UlnYv0knHSBlDWmx0GaACdSlq98Jt42cYoc3igm9be8KSBnFeVSywm3cuK9XsY4njf+0aEAzbI4pyX/mGnywq3Tm82O7xe//uPMTJvaWxejpV/z/jAml+P/9Pugqzrlf1+104SbmlE3TFMwlmlRbjlJgaXpcdRix+3VJf0tNUPD/RwF20wp8DB6RmuWGPcH1m84MMBOmjgIdTW2peXY3NyIMBA1FmNxy/39f0kOOhveP8vfZ3etzN40+LCd67GmtHe0eRsSEy/02nmjLFhGrpb62BKqEVpZY9jYZJSI1xhwqJcDGDyfE1OwETanpeBSTVW/itWbqWG9Ksw2QaKn8DE3z6zBSDwMjgCQNx10In3NgdEsuJwgMuTvAeATkcjBTAaHfltzo9o5GDk1leuN2tQxXEHmM/5PPJ4aMiBNHSzpORMKum7CMKHOK/lXu6veLq/4Wa/xs91XxTBLDczobmZ3Nc3o775DwoxHm9keBBCK62ODGGWnJ0EITcjyhvCb6zHdQjFATfOeOiqQHC2Ut0EgVpX4S8QtCF0X92zCsK45cmN9mpyENj9TU9BkI9xN4GAnx7pCcG/IjMBEkFrTXlvexOkBt7vx9zN4FZ4rLEWbETFZ4aDCRX/nTfRwxoJJReev0/Y6GP9jp3xa44WK7xcl/t4vx/gvzkqCjLU9cJCPwoFRHEHUyxkFyDE4IKGfw3//b+wx+aX7fCoj/ExeGaksx781aMwl5z4QDgOpeARHLOruQaOP8ZmvaRWdiiNCimm8Wzgcw8h8472wZ6okkd6kc7Stmp/Njz45W3MFi/r7YGe/wj2X+nn+2dfn7V+XrJ+boc8bTWcrl+7edlG78jzFWJLY/46B294tEUrDBABUH5DIaa16x3NvR+e3/fhkT3v/bhv1fGfN6jqHjlro6fq46AQ4PltgC8Q846f7z9DCQfjY81ysu7W1kJW4iy56P9CEWyIRIEUA5QAK7+5EGvp74wofHAlwn7zrdNvYWQEbcLKrtbcri5QweCeVIhEsE7gm+BfuA17wFgVdneDWF6ab8ngEEeI+WgdTPj7icwVZ5x2Sr04QmzuNiFEDogfkQ0NIH6Pk0gbIiMBlzWhocrJyeCxAZel6BLr5yf96qv5JNKscMA0iynEajyiSj/Tq7uAY3W9iDVycdqEYLNjGxutS0vBYH977x64a4AG0AHXDRZJTLX7RxonN258UlQ0e+SQRIhxeoabNQhlq6522j8AU/PCfmYx24Tglkt7e8FaY3NyFJOSVgUFrQwI2JuQAKGFMC5c/sBYMIeH3YyNLS9cEJ1ioQrCQhpvo7VddSoe5LXX+8MLfxcnQvw2YQ+LRWprg0ACoWVtWNgKf3+ZuDhAh/DHErmdLS3y773ngMXyuFwuj0dtaYnOyLDC409aWsphsQI+li34BcDCPJGyomy1fl5eprinGV+T9zwvDiYzJiaGTCYL75SoTTjAZqOsqKamQhoC1SIVHa2VlQWsQIZ6wQmgxPYkYWpCD1QQdesaHw9MmtCnTxva2xNzc23Dws5aW8tgMEdv3LgREBCRlkZuaGBzOIuKHMKjj5AHXhcCCYSTxRyH+5T3ut9l2KSirb6OuDH6PFaz5ufnbxofBw4cePz48QxVUQnbhOB3Mjs6nMlkiCugbSEHgbw1LyoCvQIYvVBkJBqVYL5RO7LuHzvffveHz9cZfHst1DTLJiDgxKVL23ft2rVx456vvtr25ptn5eQaamsXbmXnHSA+QIKAEAG7C6JkwccxKYhZ4Y/ZHHNrd7wjm/d8ljrn5OQEBQWlp6dzOPMfEIAALEzjPAERcdqEkINA3oJVBpkCCQicMwQYt8pK0DG/LRkJbrHbX1uxadky4W3zK6+J7EE3pU8/pTU2LhoOiA2qOGTtdeRsIELpEL30B5gt2IjSlVhQrCNk2u89K/Oe8iDRQLo57W8GqQcS0PcuWpCMICXN1iYEUeJHoVxITwdKIKiAwgVbBJHmv9MkGmQwcior/RITddzcpP/0PzNyMNtmce7c4uAYHkU2WCIytkhpC+JMQj4zRHLrpz9rrIPefjOxfLVezV6ngdiyeRcAoCOvqyG0tuA5nqnIyMh9+/bp6+uzn1O0B+kKAhZk7C77iyBpQdiCvPV9EHXXP6aAWFDyqCTeJ55aRBUJKqBkt8bEoKoWAkxKa+tzzD5MFquISg0iEo18fA6YmOy6ckXD0fFOVBSpuFj2tQ8kggOjqLg4ONzSEEUXZHyy23qQE1eZ2kdqQmYpnwATYGRAq4IcgYwzd3dmgM18xVt9mbdaUgv5eZ04BQUFVG1UVVVJ+rc1JTXUYv40U/Ipt8/cvrTlktomNXUp9Tvadzqb+V/XADMMltgOj7u4TR0eEt5wN/w5bM50pQKqFqQJZJ8PvPGACwqKpBVb9thYeX19eGqqqb//YTMzWQzmnI2NfUREUl5ec2encOLT+FRzbhrkVq4U3P7+44/JeXmLgwPIeGZcOVyktRtxOVpA9Gyah+7CpgZVnHCuATd4IMVNNs6O1EZhctiWxYmv+mgAGbBFNhQLE6OfF/l5iNFqvJ51aYpEHpLBYOzYsQOFo7y8XFI4SKGkluoWCAbq0qJzr6ugy2ZNXPoP8A9EHkW3Y0rnL4fcJuQl1fe0iRy5KhLJtHmaRqMBKHLx8RBR4F+4DXtmTD1gKatbWqIyMiyDg09YWu7Q0lK1srpFIMRlZdW0tvJmPycBcqU87iQrYS4um5cvR1G4sn8/igKtoQH246ysGLPbLrHhWHUVaZyqs4AVkCBiDEGugVhyzcEFRQE2NGCg2yd4A3Ifzazw/pdhJp8SDN721xY8BJttGXFeIKysrA4ePHj16tVTp06hZCgpKRkaGqqrqx89evTSpUsSIeKs6Tx94nXkdYYHJhR3f1e/zS82Ik+4sutKSFCk48OQo96GnxoofaSnoOKha5MSlFlbyhpjx6sjjy0Q4RIcxA+IIhBLUI1yu6Qkubo6PifHJizszO3bYDJ/Mje3CAy8m5ZW1djI5ogr0qNPPemumozWIwzGltcm1GhJRob4J2EKHLRe5IAJEp464xPVZtCnW60F99QdEIeIuV4Jcs0QifKFK1Z41ufd/uSjvj/ZtWl4Lv0PTuTkyZOb5hzKysqSJZfiGs3tmsITb3bYrIc25Qs7Q31Dwk+wOWfT1zGlqCrSJlTBWuv7+IYXEusauvNckLAfEb9tSMhBTrhxh+0dkt7Pxa5bxhS0H7/t7S0fGmqfk9M9vEDrV47vTLecDOpBNjaCJGKnrb1AOC45IZvUkKj0Z0lhFMmnIPXtyBATGXxDR9TNtfbzZemzoWTA/1u78Pn8dzMZgsQbPpff8JrIJq94qZ8NvZPTWlNL7yrtbYGkg+6Xjr7lQ8loYwzM+xkqKyvnJuPQoUPNzc2SnmKIDVg5LDrxWHksoCDyhKzYLAEZBCsCjztX7hO0CbU0793ZwvTehMy4pf/KbwCBH4ZA8qEnQdkv9WZJSWF3t2TqZIgbtKdsoJG/Fok5NLT7g0l9GunpuUA4vO8jO7QQ0njqpzOQYxb8+RZsigaIrDYih0WMfJCeQUTrJkv4UcEWlyXWC4P8hKgAEBi736mWsS1ZgYGkU6qH/5uPAeyUj3cQ/zOAFgsICPAeH+7u7hAkUCYgocCe+/fvj46OLuwS9Db0Ruf+1qlb/HPSR7e/aA/ZhJ8rR8cMlAwEWmQOMgaGh7PJZN+EBDCZmsfuz4YFulXlTF4MI2PclMY2vdxc8Mar8XgwyQnNzWIa44ZH/QSlitYceuBtO+GSBk8SXz1t9fmz8HCLgMw49+h20nLm/XuuIl0D4r72kYdeAg54w6PDmbUqbpZo2HDcgalRdKFdjwU/LGlhDRwskAHKg7voAkOkSyQ6/U6XneCur7Ev3NbYrMGHG5ckCBthtmFTBBCLVVhdHZSSYuDldcDYWA6LveTo6BodnXi3xkeaT4DvZiTbDumqQEbpSL7rJBm2Cm0ibcLOygnmGoeGnMlkELCgTlSIxEAqFdzy3G++OXMw7nz1wZU7BHC4X7sm0cefVZDC5TEbGcd/RYprkO1qXJH9oFeoLTMfDXLEdMdBqM1DUaAO8i0iuBX07tYYawCiMCYD4KhVditbdRXiypMNlnUqHq16kd1uafSUShalY7YiCuhQgCMlJWXxlvi+1310+n1NfEGKAhZwW3ObJv/iOX1LAAe1rLa8ri6URDLF4Q6ZmoLJPG9r63D3bnJ+fnNXF2oyuWwk/OAEBGTh5PuULz7Q/STjKW3C77XNFX6yE2kTAhOE2tojDx8CJcAKEDN3l2fvhx8K4KgqKFg4HCkFSDYZQScRksthMwSXhAQRESn1ienfronouCHdA/yaGHOVIcaaje4/YYmU1/Et7szpljumlxs5fT+dzXrd7zLQYFdOxFVnobf/EqxbR+en2KKeJuHyK7O0pT+yuNP+AbhiCCrktdeLl2tUfGYIKQkAajwbCCTBozXuKUCGtLR0D7lx8YsKfIx90OlPCUqhFFDQ28bKxmAyDZWN0LsX5DXBZJ66det2SEhcdnYdjTajySzBTRCQZTO1FMtFgnZPBo/Ey0LnbRChj8zaJmSMjYHZgVwDGWdDZCRIkxkpkV0xUUcHSiRdJ7vsWSRE9L340yyvgxRNa7JecZ2AQ/cBb28CsiYUCfgh8sleL8Ij/k6Isk1z/pZH5wgd+JjxoUMPPEU8bUlPiwTKq7F3KI0Kqac3MAfcMsSViENmAMeWTdK5X+qVvKFZtEwNLHTFGuMnUlZUOXsUI8Cr3TweNvgr2CAOwUEAPjgauG7h44N3RQmgFFUHO4QKaNipoXVxqwZ6N9Qramw+k8nqR/xl+XN/9yg/hEwpBXVP0Rxp5nNJK5E2oZzeT8dPKieRs2Pqa4CSVUFBUtHREEtaGZMF/gNffIHCoauiIum1MQHH6BhS24YMj/CrW9PHnagJODxPZT5+wuy3SBn+ykw9cXQjlr/T1H/hl2YajSpsXNUzCIu81l1cXFA1WlxcLKiywKwzC5uAgMGECqCh2ysdhQNAgQ3iEHADaQsYApKAp4j31BLX6ZV+Yayz6RJKgPlGDY2ZSl5Xdl1hMef/gkLDI/7Eg+DoqpzhUUFaCT2AtIq9ZqGfSTfR5VdCARG0TXg20OJqSsTh5ASgRCYuDqXklJQUCkeQre0C4Zh7WDwTp/ZnycgKDHLcF2nsTS+b2FnRvKjp/GuIsQCOHtbwYg4F19bevXtROEpLSyX9887+/tSSEreYGA2z20dOXzmtYYDZhRFwYLRTp/icX9oRl9vbdAU7vb7ShAQHbDUc90UDUo9f1hCJApJIOKnlOvLnPu7cLMoxCwnag9w7zg8wEg1qaan0q6+mxcRMaxPKS7kabcJ7r/Dzk3r7bRQOnJXVfwSOw8ETHEDS6X/m9k9Z8ffImiDWpYuC45u75igZx0m+i22l8njbt29H4WhpmZKeampqfvzxxy1btgjv7xsayiKTvePjsW5uCnp6+/T04IZPfDzs7B8aEq6Tmh02Ax8rQBBtuGBkMP0NnaO1XRCT+sMLQSmj0ahmrxMQE7a+OvsTR0hntSpeuC1jAEe44ggjt/45fg8IPu89D49IT08Xff2u1tbpbcLtF5QEanTLXvlAcomYR8578ODw+vViwfG++6Ql+Wk8KRILJu4eskKUkxf+8RicUbTa8UWoydiil6dXVVWhZAAiIqoQranLy8unl5QEJCfre3ntNzKSx2IvOzlBqICA0dXfP/3U63+vz++6Sau317fXFNe4YFzwN/HkLDJKTLx3/BxvJhmLVIeNQDpr9qpCs0a0bCOwUroSC/6LstW66UIwKGgQTHM4r+nj5sWL5Tk5cKO9qenEhg3CNYzejinrKNrq6/etXj3Zb/vmb//javsnN6d1nlbYOL/U6kLG6MiMLzHCYKC9GLHgWOaNyGImaLhoj+Af8OsZcFvJEKloRz4TTyd0s4Z2xzs+olGmaPieFjRsKCQ6Lf5Kcnd3R+E4c+bMhBJks0tra0NIpG0yMnyh+u9/X7Czc7x7l1hQ0NI1z9K19ob2ifKoHDbCIQIcrLDa0NyuyWLMrDbo47EpxwFpGq81D7cjaHkj226y2TScWQvSp1EnNnFnWfB3vYT1jRXrfwW9zPfqXumA1GxWC3fzZjeNxqDTD65bJ9JrNVVVFc6w+z//XPjRK/v3w/7U5rof4yLe8vV+193u9euq/7qpejnUWqRN2NfVhbZtxYJjbRhy3GoCDhCn3+tPmJSKeoTUhqyPEGvmohpKAALPqnThnf7V2Sgcn4cYLR4OLBY7URvFYi0CA49ZWMhgMKfBZOLxO3ftgv1e3t7iH62vo0+YhtyE3F+P/yq463fNb6IhgEsULedPPSEc1oTebJ7W8wKABD6lndgDUQRiCSQmUMdgtaq+NW9QxXU5k0DEiCQjWwxmeiNeY/fuSR/HYsk+UxuwgTSprZj85jOHx4tsaNiXmLjS318+3F/R+7pIm5B47y68hFhwqKYi+5+VRA9en7jhfX98PnIQvVyxzjWIzROPfIfGplxtx0g+KBxG+dELzru1bW1xWVm3Q0K2y8mhcKiZmESlp1Oam9GF1Onp6eh+Pz8/8Y/MHGJOqtH9Rk95T00PmQr2VOZMGA967zwrjYc7J6a/ctpVFHd+4qEQZYQzItqnBHcN8rYFG1EtYwvJqOIzwzoVjxub96db4ba+JrrWC6Y/Z2rdz0pdfd5+W+PQkFF+/mo8Xi4+3r28mFBARNuE72Hlx7gcseBoHEL+z2hKMfSYBb/klUbj1zwGFrq4qY0x8DFeH2291tK7Btkjlf20eVePQsBs7uxMzs93iIg4Z2Mji8EcNjMzxeHwRCLoTRSCoqlf1HF2dkb3JyUlLQwOkx9MhvqGBCs8tGW1eWIvMYEPhKaV2F9EeqeTYaMlW+gqqkaiTs5wHFC+/ZHFHvvOX/9CToSMba+/nkQQze7Xf/55YvXo8uXDg4NztbXHA4liUtKa0FC0kI3+XLG46zmMo6bAcSsKMS9CVuP5fEg6rubenaNH/+09895nizSbh/vSaPySXEdf36Pi4jtRUZccHeWw2APGxobe3kFEYmF1NWO8xTAwMGBvby9ow7q6urLZbC6XS6PRQkJCQIfCTn19fYnep6AkCpv7VfesuMkerIO6g0SHAixQCGrGUxCzZ0pCEa6KsoeRznIke86SxAVZWQEWyitXG3y4JfHNn0Hhgl6BxITW8UBUCi/3GhoQq+MlsopRXDiaOqfA8U9vRCMTMoXEZOBr8uZdw+H1JL2PTo8vzv9XoOnFO44Kurrf6+vruLv7JiRkV1YOPFvlQKVSL168CNFCUVFRWlp603yDNPuXQmccxGCigIaSRyXZ97MFdwPNAyU6VB1xggMfqad+W8eES6J+25AeIY1OK0IStfgyZY6hq6IimPWa8aVuvOFRsNMd1ikgaSEBgZG2/+6w4DmH/v73sQWtXRUXjob2STJO3UIW/GMWQdTceeHYZqYrr6Oj5uxoE333cVlZ10zU9/b2yowbEDHH5s2bASaJ3iooTRQFZ01nuFtfUS+AI0vMdQmoN2Eya5OTo1Wbpzfocds5TWkSfwlDWEzYaGpypxXvH3uFbF0++UWE+zJYcECsaV8YeG5wAA1m/nyHcsGOv2BswWOEMyYTZwsiY2Wg0JIwL7X37TVWemqt8sMaEMPaeub/hWQOh2Ntba2kpLR169Z5yYCnpaamSvpWB7oHDJUMvQy80AI5CFIXLRcdeZ0k3MzCBcwIJXaa4OByn0RH0woLOSxepjWC2zHest/Cr5RnWj+lROcCNxJfYEIru2A78vXXUd7e9P5+FpNZVVAAuIA4nfzawc9n+sMLwQFVrDFGf40H7oq0kBYLx+IHm8OpbGy8m5ZmHhh41NwcTOZZa+sbocHfEsxMMiN5f9Af1mnNzW0Q4pLLRhhdwNmzS47Ho8bH91AoEh2TOTwsaKfNve3//HPh9cMQPCCEgOWB1ANuuc0omp5SOUfv+j8IB5fHq2ltjc3KsiIQVK2sdmhpnbC0vInHR2dkVLe0vCS/X1sWFMSc8wtwA42NdUSipIellpXtevfduckAkzLbcmLwyYzc+nbzeKqcfckKDPwLeoUx7YtIzxMOMJlNnZ2JeXn2ERG/2NhAbDhy44aZv394ampFfT37ZfphHVCUwQr8HmzRfGU3NoNRQZirxpwRP3ORnlJcfGDNmtnIOLhuHTEsTCynPTwK8SPqB4Oqb80rhBYFPwc4aL29pOJil6godQeHXVeu/GBiYuTjE0wkFlOpTBYLeVlHfz2/TT9eLY1gzWkj6a2tVffuLexVQGQE29mdkpKSeestAELho49MTpyIw+E6mhfYKBepw0oMRy+dnl5e7hkXh7lzZ8/Vq4oGBlfd3XGJiTmVlYMMBrI0po6WrCyQHXM8of7hw/aSkhfzzc8PB53ByK2qwiUl6Xp4KBkYABAYFxeP2Nj0srKeOetuS2NcgbLJYWGzSU5wMZSYmKcvqvyaAQ7m6GhxTQ3+wQNjH58fr13bqa2tZm/vEhn5sKiI1rP03/BIHvwHBipCQ2sSEiCDjI3/7Bj428HmZrC4YFXGXuAfIuPDAVKR3NAQkZp6IyDg6I0bICR/sba2Cw9PzM1t7OhY+vXWxQ+goYtMhiBR7OsLEhVYqU1O7m9oeMHf9jIOlwtC8uebN63w+JjMTGpr69J/krI00PH/ioo50TSXCOIAAAAASUVORK5CYII='
    }
    const a = await service.resolveImageCaptcha(captcha)
    console.log(a)
    expect(a).toBeDefined()
  }, 60000)
});
